From d5e9a65c59adfe1fee4027a611ec8e9e74145f4c Mon Sep 17 00:00:00 2001
From: Vladimir 'phcoder' Serbinenko <phcoder@gmail.com>
Date: Fri, 3 May 2013 13:56:45 +0200
Subject: [PATCH 406/482] 	* grub-core/normal/term.c (print_ucs4_real):
 Fix startwidth in dry run.

---
 ChangeLog               | 4 ++++
 grub-core/normal/term.c | 4 ++--
 2 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/ChangeLog b/ChangeLog
index 3ff4a05..9e99eb5 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,7 @@
+2013-05-03  Vladimir Serbinenko  <phcoder@gmail.com>
+
+	* grub-core/normal/term.c (print_ucs4_real): Fix startwidth in dry run.
+
 2013-05-02  Vladimir Serbinenko  <phcoder@gmail.com>
 
 	Several fixes to ieee1275 and big-endian video.
diff --git a/grub-core/normal/term.c b/grub-core/normal/term.c
index f9620f6..9764423 100644
--- a/grub-core/normal/term.c
+++ b/grub-core/normal/term.c
@@ -920,8 +920,8 @@ print_ucs4_real (const grub_uint32_t * str,
 						get_maxwidth (term, 
 							      margin_left,
 							      margin_right),
-						get_startwidth (term, 
-								margin_left),
+						dry_run ? 0 : get_startwidth (term, 
+									      margin_left),
 						contchar, pos, !!contchar);
       if (visual_len < 0)
 	{
-- 
1.8.2.1

